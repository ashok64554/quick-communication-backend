(select `smspannel`.`send_sms`.`user_id` AS `user_id`,date_format(`smspannel`.`send_sms`.`created_at`,'%Y-%m-%d') AS `send_date`,sum(`smspannel`.`send_sms_histories`.`use_credit`) AS `total_credit`,count(`smspannel`.`send_sms_histories`.`id`) AS `total_submission`,count(if(`smspannel`.`send_sms_histories`.`stat` = 'DELIVRD',0,NULL)) AS `total_delivered`,count(if(`smspannel`.`send_sms_histories`.`stat` = 'PENDING',0,NULL)) AS `total_pending`,count(if(`smspannel`.`send_sms_histories`.`stat` = 'Invalid',0,NULL)) AS `total_invalid`,count(if(`smspannel`.`send_sms_histories`.`stat` = 'EXPIRED',0,NULL)) AS `total_expired`,count(if(`smspannel`.`send_sms_histories`.`stat` = 'FAILED',0,NULL)) AS `total_failed`,count(if(`smspannel`.`send_sms_histories`.`stat` in ('REJECT','REJECTD'),0,NULL)) AS `total_reject` from (`smspannel`.`send_sms` join `smspannel`.`send_sms_histories` on(`smspannel`.`send_sms`.`id` = `smspannel`.`send_sms_histories`.`send_sms_id`)) group by cast(`smspannel`.`send_sms`.`campaign_send_date_time` as date)) union (select `smspannel`.`send_sms`.`user_id` AS `user_id`,date_format(`smspannel`.`send_sms`.`created_at`,'%Y-%m-%d') AS `send_date`,sum(`smspannel`.`send_sms_queues`.`use_credit`) AS `total_credit`,count(`smspannel`.`send_sms_queues`.`id`) AS `total_submission`,count(if(`smspannel`.`send_sms_queues`.`stat` = 'DELIVRD',0,NULL)) AS `total_delivered`,count(if(`smspannel`.`send_sms_queues`.`stat` = 'PENDING',0,NULL)) AS `total_pending`,count(if(`smspannel`.`send_sms_queues`.`stat` = 'Invalid',0,NULL)) AS `total_invalid`,count(if(`smspannel`.`send_sms_queues`.`stat` = 'EXPIRED',0,NULL)) AS `total_expired`,count(if(`smspannel`.`send_sms_queues`.`stat` = 'FAILED',0,NULL)) AS `total_failed`,count(if(`smspannel`.`send_sms_queues`.`stat` in ('REJECT','REJECTD'),0,NULL)) AS `total_reject` from (`smspannel`.`send_sms` join `smspannel`.`send_sms_queues` on(`smspannel`.`send_sms`.`id` = `smspannel`.`send_sms_queues`.`send_sms_id`)))

(select `smspannel`.`send_sms_queues`.`submit_date` AS `submit_date`,floor(timestampdiff(SECOND,`smspannel`.`send_sms_queues`.`submit_date`,`smspannel`.`send_sms_queues`.`done_date`)) AS `difference_in_seconds`,count('difference_in_seconds') AS `total_delivered` from `smspannel`.`send_sms_queues` where `smspannel`.`send_sms_queues`.`stat` = 'DELIVRD' and floor(timestampdiff(SECOND,`smspannel`.`send_sms_queues`.`submit_date`,`smspannel`.`send_sms_queues`.`done_date`)) < 30 group by floor(timestampdiff(SECOND,`smspannel`.`send_sms_queues`.`submit_date`,`smspannel`.`send_sms_queues`.`done_date`))) union (select `smspannel`.`send_sms_histories`.`submit_date` AS `submit_date`,floor(timestampdiff(SECOND,`smspannel`.`send_sms_histories`.`submit_date`,`smspannel`.`send_sms_histories`.`done_date`)) AS `difference_in_seconds`,count('difference_in_seconds') AS `total_delivered` from `smspannel`.`send_sms_histories` where `smspannel`.`send_sms_histories`.`stat` = 'DELIVRD' and floor(timestampdiff(SECOND,`smspannel`.`send_sms_histories`.`submit_date`,`smspannel`.`send_sms_histories`.`done_date`)) < 30 group by floor(timestampdiff(SECOND,`smspannel`.`send_sms_histories`.`submit_date`,`smspannel`.`send_sms_histories`.`done_date`)))